import{j as e,a7 as K,a8 as G,a9 as Z,aa as o,ab as ee,ac as te,ad as re,ae,af as oe,ag as se,l as le,r as s,ah as ie,C as ne,X as de,a5 as l}from"./vendor-LjbCKWXj.js";import{u as ce,a as ue,b as me,A as xe}from"./index-DLufcNUo.js";import{D as Y,M as O}from"./monetaryUtil-Ccsb3nQ9.js";import{S as E,a as $,C as be}from"./Select-C8PQA4vz.js";import{u as he}from"./useConfirmation-DIkYVyS7.js";function fe({...r}){const c=u=>{let n=u?r.value+1:r.value-1;n=Math.max(1,Math.min(n,r.max||100)),r.setValue(n)};return e.jsxs("div",{className:"flex items-center justify-start",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),disabled:r.value===1,className:"transition-all duration-300 ease-in-out text-tertiaryColor disabled:text-tertiaryColor/50",children:e.jsx(K,{size:22,weight:"bold"})}),e.jsx("input",{type:"number",className:"block w-20 h-12 px-3 py-2 mx-4 text-center bg-opacity-0 border rounded-md shadow-sm text-tertiaryColor bg-secondaryColor border-tertiaryColor placeholder-tertiaryColor focus:outline-none focus:border-primaryColor focus:ring-primaryColor focus:ring-1 invalid:border-errorColor invalid:text-errorColor focus:invalid:border-errorColor focus:invalid:ring-errorColor disabled:border-tertiaryColor disabled:text-tertiaryColor",value:r.value,disabled:!0}),e.jsx("button",{type:"button",onClick:()=>c(!0),disabled:r.max?r.value===r.max:r.value===100,className:"transition-all duration-300 ease-in-out text-tertiaryColor disabled:text-tertiaryColor/50",children:e.jsx(G,{size:22,weight:"bold"})})]})}o.extend(oe);o.extend(se);o.updateLocale("pt-br",{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],weekdaysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"]});function pe({value:r,onChange:c}){const u="#FFF",n="#FFCE08",w=Z({palette:{primary:{main:n}},components:{MuiOutlinedInput:{styleOverrides:{root:{color:u,height:"3rem",paddingTop:"0.25rem",border:`1px solid ${u}`,borderRadius:"0.375rem",backgroundColor:"#000","& .MuiIconButton-root":{color:u},"&.Mui-focused":{borderColor:n,"& .MuiIconButton-root":{color:n}},"&.Mui-error":{borderColor:"#f44336","& .MuiIconButton-root":{color:"#f44336"}}}}}}}),y=o(),d=y.add(1,"hour"),N=y.add(3,"month");return e.jsx(ee,{theme:w,children:e.jsx(te,{dateAdapter:re,children:e.jsx(ae,{minDate:d,maxDate:N,value:o(r),onChange:D=>{D&&c(D.toDate())},format:"DD/MM/YYYY"})})})}o.locale("pt-br");function Ne(){const{authToken:r}=ce(),c=le(),{dispatch:u}=he(),{dispatch:n}=ue(),w=s.useRef(!1),y=o(),[d,N]=s.useState(""),[D,M]=s.useState(null),[C,H]=s.useState(""),[f,J]=s.useState(1),[m,S]=s.useState(y.add(1,"hour").toDate()),[x,T]=s.useState(""),[z,k]=s.useState(),[p,A]=s.useState(""),[L,F]=s.useState(!1),[R,g]=s.useState(!1),[j,Q]=s.useState(null),B=[{value:"6 horas",label:"6 horas"},{value:"7 horas",label:"7 horas"},{value:"8 horas",label:"8 horas"},{value:"9 horas",label:"9 horas"},{value:"10 horas",label:"10 horas"}],U=t=>{t.preventDefault();const a=o(m).format("YYYY-MM-DD"),v=o(`${a} ${x}`,"YYYY-MM-DD HH:mm").toDate();F(!0),g(!0),setTimeout(async()=>{if(r&&j){const b={establishment:j.corporateReason,assignment:d,description:C,quantity:f,jobDate:v,jobTime:p,jobValue:I(),status:"open",contractorId:j.id,createdAt:new Date},h=await xe.request({origin:"Web",method:"POST",url:"/vacancies",data:b,authToken:r});if(h.success&&h.data)n({type:"SHOW_ALERT",payload:{type:"success",text:"Vaga criada com sucesso"}}),P(),setTimeout(()=>{c("/contratante/inicio")},3e3);else{let i="";h.statusCode!==404?h.statusCode===409?(i="Você não pode criar uma vaga antes de encerrar os serviços que já foram concluídos",P()):i="Houve um erro inesperado ao criar a vaga":i="Houve um erro ao criar a vaga",n({type:"SHOW_ALERT",payload:{type:"error",text:i}})}}g(!1),F(!1)},4e3)},P=()=>{N(""),M(null),H(""),S(y.add(1,"hour").toDate()),T(""),J(1),A(""),k(null)},q=()=>{let t=parseInt(x)+parseInt(p);return t>23&&(t+=-24),x+" - "+(t<10?"0"+t:t)+":00"},I=()=>{const t=parseInt(p.split(" horas")[0]);return O.getJobValueByHours(d,t)},V=t=>{if(!t||t.length<5)throw new Error("invalid time: "+t);const a=m.getDate().toString().padStart(2,"0"),v=(m.getMonth()+1).toString().padStart(2,"0");return`${m.getFullYear()}-${v}-${a} ${t}`},W=async()=>{if(w.current=!0,r){const t=await me.getContractorByUser(r);Q(t)}},_=t=>{if(t){const a=o(new Date);if(o(t).isAfter(a)&&o(t).isBefore(a.add(3,"month")))return!0}return!1},X=()=>{g(!0),u({type:"SHOW_CONFIRMATION",payload:{title:"Confirmar ação",message:"Deseja descartar as informações preenchidas?",onConfirm:()=>{c("/contratante/inicio")},onCancel:()=>{g(!1)}}})};return s.useEffect(()=>{w.current||W()},[]),s.useEffect(()=>{d&&C.length>0&&f&&_(m)&&x.length===5&&p?g(!1):g(!0)},[d,C,f,m,x,p]),e.jsx(e.Fragment,{children:j?e.jsxs("form",{onSubmit:U,className:"relative w-full h-full min-h-screen desktop:px-96 laptop:px-44 tablet:px-20 mobile:px-2 mobile:pb-28 mobile:pt-16 bg-secondaryColor",children:[e.jsxs("div",{className:"fixed flex justify-center items-center top-0 left-0 right-0 w-full h-12 bg-primaryColor z-[999] text-tertiaryColor",children:[e.jsx("span",{className:"text-2xl font-semibold text-center",children:"Criar vaga"}),e.jsx("button",{type:"button",className:"absolute right-0 top-3 desktop:mx-96 laptop:mx-44 tablet:mx-20 mobile:mx-2",onClick:X,children:e.jsx(ie,{weight:"bold",className:"w-6 h-6 mr-2"})})]}),e.jsx("div",{className:"flex justify-start w-full mb-1",children:e.jsx("span",{className:"text-tertiaryColor/50 text-start",children:"Estabelecimento"})}),e.jsx("textarea",{id:"establishment",className:"block w-full h-12 px-3 py-2 bg-opacity-0 border rounded-md shadow-sm resize-none text-tertiaryColor bg-secondaryColor border-tertiaryColor placeholder-tertiaryColor/50 focus:outline-none focus:border-primaryColor focus:ring-primaryColor focus:ring-1 invalid:border-errorColor invalid:text-errorColor focus:invalid:border-errorColor focus:invalid:ring-errorColor disabled:border-tertiaryColor/50 disabled:text-tertiaryColor/50",value:j.corporateReason,disabled:!0}),e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Função/Atribuição"})}),e.jsx(E,{placeholder:"Selecione",isSearchable:!1,name:"assigment",options:be.getVacancyCombo(),styles:$.getCustomStyles(),noOptionsMessage:()=>"Nenhum resultado encontrado",onChange:t=>{t&&t.value&&(M(t),N(t.value),k(null),A(""))},value:D},1),e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Descrição"})}),e.jsx("textarea",{className:"block w-full h-64 px-3 py-2 bg-opacity-0 border rounded-md shadow-sm resize-none text-tertiaryColor bg-secondaryColor border-tertiaryColor placeholder-tertiaryColor/50 focus:outline-none focus:border-primaryColor focus:ring-primaryColor focus:ring-1 invalid:border-errorColor invalid:text-errorColor focus:invalid:border-errorColor focus:invalid:ring-errorColor disabled:border-tertiaryColor/50 disabled:text-tertiaryColor/50",maxLength:500,value:C,onChange:t=>H(t.target.value)}),e.jsx("span",{className:"self-end text-sm text-tertiaryColor",children:`${C.length} / 500`}),e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Quantidade de Freelancers"})}),e.jsx(fe,{max:10,value:f,setValue:J}),e.jsx("div",{className:"mt-2 text-sm font-semibold text-primaryColor",children:"*A data do serviço deve estar entre 1 hora à 3 meses depois da data atual."}),e.jsxs("div",{className:"flex justify-start laptop:flex-row mobile:flex-col",children:[e.jsxs("div",{className:"flex flex-row desktop:w-[60%] laptop:w-[60%] tablet:w-[100%] mobile:w-full laptop:justify-start mobile:justify-between",children:[e.jsxs("div",{className:"laptop:w-[45%]",children:[e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Data do serviço"})}),e.jsx(pe,{value:m,onChange:S})]}),e.jsx("div",{className:"flex flex-row items-center justify-center w-10 mt-10 font-bold text-tertiaryColor",children:e.jsx("hr",{className:"w-4"})}),e.jsxs("div",{className:"laptop:w-[55%]",children:[e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Horário inicial do serviço"})}),e.jsx("input",{id:"jobHour",className:"block h-12 px-3 py-2 bg-opacity-0 border rounded-md shadow-sm resize-none mobile:w-full w-28 text-tertiaryColor bg-secondaryColor border-tertiaryColor placeholder-tertiaryColor/50 focus:outline-none focus:border-primaryColor focus:ring-primaryColor focus:ring-1 invalid:border-errorColor invalid:text-errorColor focus:invalid:border-errorColor focus:invalid:ring-errorColor disabled:border-tertiaryColor/50 disabled:text-tertiaryColor/50",maxLength:3,value:x,onInput:t=>{let a=t.currentTarget.value;if(/^([01]?[0-9]|2[0-3]|)$/.test(a)){if(a.length===2){a+=":00";const v=o(Y.stringToDate(V(a))),b=o(new Date).add(1,"hour");if(v.isBefore(b)){const h=parseInt(b.format("HH"));let i;h===23?(o(Y.stringToDate(V("00:00"))).diff(b,"hour")>=1||S(b.add(1,"hour").toDate()),i="00:00"):(i=`${h}:00`,i.length<5&&(i="0"+i)),a=i}}T(a)}},onKeyDown:t=>{t.keyCode===8&&T("")}})]})]}),e.jsxs("div",{className:"flex flex-col justify-start desktop:w-[40%] laptop:w-[40%] tablet:w-[100%] mobile:w-full laptop:ml-10 mobile:ml-0",children:[e.jsx("div",{className:"flex justify-start w-full mt-2 mb-1",children:e.jsx("span",{className:"text-tertiaryColor text-start",children:"Tempo de serviço"})}),e.jsx(E,{placeholder:"Selecione a qtde de horas do serviço",isSearchable:!1,name:"jobTime",options:d.includes("Músico")?[{value:"3 horas",label:"3 horas"},{value:"4 horas",label:"4 horas"},{value:"5 horas",label:"5 horas"},...B]:B,styles:$.getCustomStyles(),noOptionsMessage:()=>"Nenhum resultado encontrado",onChange:t=>{t&&t.value&&(k(t),A(t.value))},value:z,menuPlacement:"auto",menuPortalTarget:document.body},2)]})]}),d&&f&&x.length===5&&p&&e.jsxs("div",{className:"flex flex-col mt-2 w-ful",children:[e.jsxs("div",{className:"flex justify-row",children:[e.jsx("span",{className:"text-tertiaryColor",children:"Horário início/fim do serviço:"}),e.jsx("span",{className:"ml-1 font-semibold text-primaryColor",children:q()})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-tertiaryColor",children:"Valor a ser pago:"}),e.jsx("span",{className:"ml-1 font-semibold text-successColor",children:d!==""&&O.getJobValueByProfile("contractor",I(),f)})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 flex items-center justify-center w-full h-20 bg-[#111]",children:e.jsx("button",{type:"submit",className:"laptop:w-96 mobile:w-[19rem] flex items-center justify-center h-16 font-bold transition-all duration-500 ease-in-out border-4 shadow-lg mobile:text-base border-primaryColor shadow-primaryColor/40 text-primaryColor hover:text-tertiaryColor rounded-xl hover:bg-primaryColor disabled:cursor-not-allowed disabled:bg-primaryColor/80 disabled:text-tertiaryColor/80 disabled:border-primaryColor/20",disabled:R,children:L?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(ne,{weight:"bold",className:"w-6 h-6 mr-3 animate-spin"}),e.jsx("span",{children:"Criando e publicando a vaga..."})]}):e.jsx("span",{children:"Criar e publicar"})})})]}):e.jsx("div",{className:"w-full h-screen desktop:px-80 laptop:px-36 tablet:px-24 mobile:px-2 mobile:pt-2 mobile:pb-32 bg-secondaryColor",children:e.jsxs(de,{children:[e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"7.5rem",height:"1rem",className:"mx-auto mt-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"7.5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"3rem",className:"rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"8.5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"3rem",className:"rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"16rem",className:"rounded-md"}),e.jsxs("div",{className:"flex justify-start w-full h-24 laptop:flex-row mobile:flex-col",children:[e.jsxs("div",{className:"flex flex-row desktop:w-[50%] laptop:w-[60%] tablet:w-[60%] mobile:w-full laptop:justify-start mobile:justify-between",children:[e.jsxs("div",{className:"flex flex-col w-[17rem]",children:[e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"7.5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"3rem",className:"rounded-md"})]}),e.jsx("div",{className:"flex items-end justify-center w-10 h-full",children:e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"55%",height:"0.2rem",className:"mb-6 rounded-md"})}),e.jsxs("div",{className:"flex flex-col w-[7.5rem]",children:[e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"7.5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"3rem",className:"rounded-md"})]})]}),e.jsxs("div",{className:"flex flex-col w-full laptop:ml-10",children:[e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"7.5rem",height:"0.6rem",className:"mt-[1.75rem] mb-2 rounded-md"}),e.jsx(l,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"100%",height:"3rem",className:"rounded-md"})]})]})]})})})}export{Ne as ContractorCreateVacancy};
